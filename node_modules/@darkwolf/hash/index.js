const crypto = require('crypto')
const base58 = require('@darkwolf/base58')

class Hash {
  constructor() {}

  get Hash() {
    return Hash
  }

  createHash(secret) {
    return base58.encode(crypto.createHmac('sha256', secret || crypto.randomBytes(64)).digest('hex')).slice(20, 84)
  }

  createUID(secret) {
    return this.createHash(secret).slice(0, 20)
  }

  createUid(...args) {
    return this.createUID(...args)
  }
}

module.exports = new Hash()
